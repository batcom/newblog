# Windows Terminal 美化

<!--标题：Windows Terminal 美化｜分类：shell｜标签：Windows,terminal,git,shell -->

> 因为总是换机器，每次都遇到新的Windows Terminal美化的问题，所以，在这里总结记录一下，方便查询和更新，节省以后新机器上配置这些的时间。

---

## 总结

通过总体测试体验，Windows Terminal原生的方案体验是最好的，其它上面模拟zsh方案启动终端性能都存在问题，所以，优先配置Power Shell + oh my zsh方案。然后就是wsl + linux +zsh的方案，性能也会更好些，因为走过很多弯路，所以，其它方案就不在测试了，性能都有问题。不过总体思路总是zsh +oh my zsh方案的。其中的`powerlevel10k`后期有时间可以深入研究下.

### 原生的Windows Terminal + Power Shell + oh my zsh方案

#### Windows Terminal 安装和配置

1. `https://github.com/microsoft/terminal` github 直接 `Release` 下载想要的版本，双击安装。

2. 配置如下

   ```json
   // This file was initially generated by Windows Terminal 1.8.1444.0
   // It should still be usable in newer versions, but newer versions might have additional
   // settings, help text, or changes that you will not see unless you clear this file
   // and let us generate a new one for you.
   
   // To view the default settings, hold "alt" while clicking on the "Settings" button.
   // For documentation on these settings, see: https://aka.ms/terminal-documentation
   {
       "$schema": "https://aka.ms/terminal-profiles-schema",
   
       "defaultProfile": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
   
       // You can add more global application settings here.
       // To learn more about global settings, visit https://aka.ms/terminal-global-settings
   
       // If enabled, selections are automatically copied to your clipboard.
       "copyOnSelect": false,
   
       // If enabled, formatted data is also copied to your clipboard
       "copyFormatting": true,
       "wordDelimiters": " /\\()\"'-.,:;<>~!@#$%^&*|+=[]{}~?\u2502",
       // Tab UI
       "alwaysShowTabs": true,
       "showTabsInTitlebar": true,
       "showTerminalTitleInTitlebar": true,
       "tabWidthMode": "equal",
       // Miscellaneous，杂项
       "confirmCloseAllTabs": true,
       "theme": "system",
       "rowsToScroll": "system",
       "snapToGridOnResize": true,
   
       // A profile specifies a command to execute paired with information about how it should look and feel.
       // Each one of them will appear in the 'New Tab' dropdown,
       //   and can be invoked from the commandline with `wt.exe -p xxx`
       // To learn more about profiles, visit https://aka.ms/terminal-profile-settings
       "profiles":
       {
           "defaults":
           {
               // Put settings here that you want to apply to all profiles.
               // profiles 里的 defaults:
               "useAcrylic": true,
               // 默认 0.5，接收浮点值为 0-1
               "startingDirectory": "./",
               "acrylicOpacity": 0.70, //亚克力背景透明度（需启用useAcrylic）
               "background": "#012456", //背景颜色，PS默认为蓝色
               "closeOnExit": true, //关闭窗口的时候退出所有挂载的程序
               "colorScheme": "Monokai Vivid", //配色方案（Dracula需导入）
               "backgroundImage": "C:\\Users\\coolnet\\Pictures\\background.png",
               "cursorColor": "#FFFFFF", //光标颜色
               "cursorShape": "bar", //光标形状（默认为bar，即条状）
               "fontFace": "Fira Code Nerd", //所用字体
               "fontSize": 14, //字体大小
               "guid": "{574e775e-4f2a-5b96-ac1e-a2962a402336}", //唯一标识符，随机生成
               "historySize": 9001, //缓存大小
               "icon": "ms-appx:///ProfileIcons/{61c54bbd-c2c6-5271-96e7-009a87ff44bf}.png", //图标
               "name": "Windows PowerShell", //在下拉菜单里显示的名称
               "tabTitle": "Windows PowerShell", //在选项卡上显示的名称
               "padding": "0, 0, 0, 0", //内容的边框距，默认填充全部空间
               "snapOnInput": true //输入的时候自动滚动到输入位置
           },
           "list":
           [
               {
                   "guid": "{574e775e-4f2a-5b96-ac1e-a2962a402336}",
                   "hidden": false,
                   "name": "PowerShell",
                   "colorScheme": "Solarized Darcula",
                   "source": "Windows.Terminal.PowershellCore",
                   "fontFace": "Fira Code Nerd"
               },
               {
                   // Make changes here to the cmd.exe profile.
                   "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
                   "name": "Bash",
                   "commandline": "D:\\soft\\git-sdk-64\\usr\\bin\\zsh.exe",
                   "hidden": false,
                   "startingDirectory": "%USERPROFILE%"
               },
               {
                   "guid": "{b453ae62-4e3d-5e58-b989-0a998ec441b8}",
                   "hidden": false,
                   "name": "Azure Cloud Shell",
                   "source": "Windows.Terminal.Azure"
               }
           ]
       },
   
       // Add custom color schemes to this array.
       // To learn more about color schemes, visit https://aka.ms/terminal-color-schemes
       "schemes": [
           {
               "name": "Monokai Vivid",
               "black": "#121212",
               "red": "#fa2934",
               "green": "#98e123",
               "yellow": "#fff30a",
               "blue": "#0443ff",
               "purple": "#f800f8",
               "cyan": "#01b6ed",
               "white": "#ffffff",
               "brightBlack": "#838383",
               "brightRed": "#f6669d",
               "brightGreen": "#b1e05f",
               "brightYellow": "#fff26d",
               "brightBlue": "#0443ff",
               "brightPurple": "#f200f6",
               "brightCyan": "#51ceff",
               "brightWhite": "#ffffff",
               "background": "#121212",
               "foreground": "#f9f9f9",
               "cursorColor": "#fb0007",
               "selectionBackground": "#ffffff"
           },{
               "name": "Solarized Darcula",
               "black": "#25292a",
               "red": "#f24840",
               "green": "#629655",
               "yellow": "#b68800",
               "blue": "#2075c7",
               "purple": "#797fd4",
               "cyan": "#15968d",
               "white": "#d2d8d9",
               "brightBlack": "#25292a",
               "brightRed": "#f24840",
               "brightGreen": "#629655",
               "brightYellow": "#b68800",
               "brightBlue": "#2075c7",
               "brightPurple": "#797fd4",
               "brightCyan": "#15968d",
               "brightWhite": "#d2d8d9",
               "background": "#3d3f41",
               "foreground": "#d2d8d9",
               "cursorColor": "#708284",
               "selectionBackground": "#214283"
           }
       ],
   
       // Add custom actions and keybindings to this array.
       // To unbind a key combination from your defaults.json, set the command to "unbound".
       // To learn more about actions and keybindings, visit https://aka.ms/terminal-keybindings
       "actions":
       [
           // Copy and paste are bound to Ctrl+Shift+C and Ctrl+Shift+V in your defaults.json.
           // These two lines additionally bind them to Ctrl+C and Ctrl+V.
           // To learn more about selection, visit https://aka.ms/terminal-selection
           { "command": {"action": "copy", "singleLine": false }, "keys": "ctrl+c" },
           { "command": "paste", "keys": "ctrl+v" },
   
           // Press Ctrl+Shift+F to open the search box
           { "command": "find", "keys": "ctrl+shift+f" },
   
           // Press Alt+Shift+D to open a new pane.
           // - "split": "auto" makes this pane open in the direction that provides the most surface area.
           // - "splitMode": "duplicate" makes the new pane use the focused pane's profile.
           // To learn more about panes, visit https://aka.ms/terminal-panes
           { "command": { "action": "splitPane", "split": "auto", "splitMode": "duplicate" }, "keys": "alt+shift+d" }
       ]
   }
   
   ```

   其中用到的附件如下:

   1. 字体：`https://github.com/tonsky/FiraCode` 下载 ,支持图标的补丁Nerd Font `https://github.com/ryanoasis/nerd-fonts`下载，提示:可以去Release 页面下载不同字体的打包文件，不用一个个文件下载
   2. 所用到的背景图片在这里`https://wallpaperhub.app/wallpapers/6277`,也备份一份到gitee仓库方便使用`https://gitee.com/batcom/static/raw/master/images/background.png`
   3. 最全的配色方案在`https://github.com/mbadolato/iTerm2-Color-Schemes` 这里，可以直接进[windowsterminal](https://github.com/mbadolato/iTerm2-Color-Schemes/tree/master/windowsterminal) 目录进行挑选
   4. 

#### Power Shell 安装或更新

在[这里](https://github.com/PowerShell/PowerShell/tags)找到最新的安装文件进行安装即可.

#### oh my zsh 安装

安装模块

打开Power Shell 管理员模式

```bash
Install-Module git-aliases -AllowClobber
Install-Module posh-git
Install-Module oh-my-posh #
Install-Module DirColors  #让 ls (Get-ChildItem) 像 Unix 系终端一样具有多彩色
Install-Module -Name Terminal-Icons -Repository PSGallery ## 重要，安装图标文件类型都可以看，测试时候需要挂代理，然后终端字体要选Nerd Font(fira)即可
```

编辑配置文件 `code $profile`，写入，保存永久生效

```bash
Import-Module DirColors
Import-Module posh-git
Import-Module oh-my-posh
Import-Module git-aliases -DisableNameChecking
Import-Module -Name Terminal-Icons 
Set-PoshPrompt -Theme marcduiker
```

#### wt 右键菜单
将下方内容复制到文本文件中，修改后缀为 .reg 并且双击打开安装即可：(**记得修改对应路径**)

```bash
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Directory\Background\shell\wt]
@="Open Windows Terminal"
"Icon"="C:\\Env\\DefaultIcons\\wt.ico"

[HKEY_CLASSES_ROOT\Directory\Background\shell\wt\command]
@="C:\\Users\\Shiroha\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe"

[HKEY_CLASSES_ROOT\Directory\Background\shell\wtp]
@="Open Windows Terminal Preview"
"Icon"="C:\\Env\\DefaultIcons\\wtp.ico"

[HKEY_CLASSES_ROOT\Directory\Background\shell\wtp\command]
@="C:\\Users\\Shiroha\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.WindowsTerminalPreview_8wekyb3d8bbwe\\wt.exe"
```

最后总结，关键重要部分，一定要用Nerd Font(比如Fira Code ) 只用Power Line字体有些文件类型图标会展示不出来，然后`Install-Module -Name Terminal-Icons -Repository PSGallery`这个记录一下可以安装`ls`时候展示文件类型，像Vscode一样，这次在这上面花了很长时间。最后，发现[ohmyposh的文档](https://ohmyposh.dev/docs/)也还蛮不错的，可以自定义主题，而且也更新快保持正确`Set-PoshPrompt -Theme marcduiker`，比如现在是这种方式设置主题，其中`prompt`即是左边提示内容，右边是命令，可以了解。

## wsl方案

测试的时候发现wsl启动就比较好用了，毕竟是Linux，所以，不需要怎么配置，要配置起来也更容易一些，毕竟是Linux，安装zsh和ohmyzsh主题，甚至是powerlevel10k都可以。后面有时间可以试下，反正性能还是可以和原生powershell相比的，以后的nvim也可以在这里面试试。这次因为Windows里面弄得比较耗时了，后期体验后再来补充。其中Terminal[图标](https://github.com/TheFern2/windows-terminal-icons)可以这里下载

## Vscode 终端美化

这次搞这个花了很多时间，本来以为很难，没想到就处在字体上，通过配置读取的错误字体导致的乱码，所以，一般只要前面power shell配置字体美化好了，这一步，只需要配置下vscode就可以了 ，主要字体要改为Nerd Font,方法搜索`terminal.internal.font` 然后找到font-family设置为`FiraCode Nerd Font`即可.	

